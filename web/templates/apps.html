{{define "content"}}
<div class="apps-header">
    <h2>Applications</h2>
    <div>
        <button onclick="document.getElementById('add-app-modal').showModal()" class="btn btn-primary">New App</button>
        <button hx-get="/ui/apps/fragment" hx-target="#apps-list" class="btn btn-refresh">Refresh</button>
    </div>
</div>

<div id="apps-list" hx-get="/ui/apps/fragment" hx-trigger="load, every 10s">
    <div class="loading">Loading apps...</div>
</div>

<dialog id="add-app-modal" class="modal">
    <div class="modal-header">
        <h3>Register New Application</h3>
        <button onclick="document.getElementById('add-app-modal').close()" class="btn-close">&times;</button>
    </div>
    <form hx-post="/ui/apps/add" hx-target="#apps-list" hx-swap="innerHTML" onsubmit="document.getElementById('add-app-modal').close()">
        <div class="form-group">
            <label for="id">App ID</label>
            <input type="text" id="id" name="id" required placeholder="e.g., my-app">
        </div>
        <div class="form-group">
            <label for="name">App Name</label>
            <input type="text" id="name" name="name" required placeholder="e.g., My Application">
        </div>
        <div class="form-group">
            <label for="repo_url">Git Repository URL</label>
            <input type="url" id="repo_url" name="repo_url" required placeholder="https://github.com/user/repo.git">
        </div>
        <div class="form-group">
            <label for="branch">Branch</label>
            <input type="text" id="branch" name="branch" value="main">
        </div>
        <div class="form-group">
            <label for="compose_path">Compose File Path</label>
            <input type="text" id="compose_path" name="compose_path" value="compose.yaml">
        </div>
        <div class="modal-actions">
            <button type="button" onclick="document.getElementById('add-app-modal').close()" class="btn">Cancel</button>
            <button type="submit" class="btn btn-primary">Register</button>
        </div>
    </form>
</dialog>
{{end}}
